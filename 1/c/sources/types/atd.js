import{IMAGE_TYPE,INVALID_TYPE,VIDEO_TYPE,YOUTUBE_TYPE}from"../../../cn/core-constants";export function atd(u,c){var a=document.createElement("a");a.href=u;var h=a.hostname;if(h==="www.youtube.com"||h==="youtu.be"){return c(YOUTUBE_TYPE);}var x=new XMLHttpRequest();x.onreadystatechange=function(){if(x.readyState===4){c(INVALID_TYPE);return;}if(x.readyState !== 2){return;}var cth=x.getResponseHeader("content-type");var ct=cth.slice(0,cth.indexOf("/"));var t;switch(ct){case"image":t=IMAGE_TYPE;break;case "video":t=VIDEO_TYPE;break;default:t=INVALID_TYPE;}x.onreadystatechange=null;x.abort();c(t);};x.open("GET",u);x.send();}
// If "readyState" 4 is executed without state 2, the request has failed (most likely because of the CORS issue), so the invalid type have to be resolved. There is no need to abort the request because it is already finished.
// After the type is detected in the "readyState" 2, the request should be aborted, but after "XMLHttpRequest.abort()" the onreadystatechange handler is triggered once again with the "readyState" 4 (https://xhr.spec.whatwg.org/#the-abort()-method), therefore, the onreadystatechange handler have to be deleted.
